<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>Mathematic Form Transfer Simulation</title>
		<style>
			canvas{
				border: solid 1px green;
			}
		</style>
	</head>
	<body>
		<!--
						table design reference:
						http://www.wibibi.com/info.php?tid=441
		-->
		<table>
				<tr>
					<td><p id = "inputMathForm">這是一個可以輸入數學中序式後，可以轉成前序或後序式的模擬程式</p></td>
				</tr>	
		</table>
		<hr>	
		<form name = "mathForm" id="mathForm">
			<table  style="border:3px #FFD382 dashed;" cellpadding="10" >
				<tr>
					<td>
					
					<table>
						<tr>
							<td><p id = "inputMathForm">輸入中序：</p></td>
							<td><input type=text value="" id = inputInfix size="30" ></td>
						</tr>	
					</table>
					<table>
						<tr>
							<td><p id = "changeTo">轉換為：</p></td>
							<td>
								<input type="radio" name="fix" value="前序" onClick = "fixChoice();">前序
							</td>
							<td>
								<input type="radio" name="fix" value="後序" onClick = "fixChoice();">後序
							</td>
							<td>
								<p id = "fixWord"></p>
							</td>
						</tr>	
					</table>
					<table>
						<tr>
							<td><p id = "modePrompt">操作模式：</p></td>
							<td>
								<input type="radio" name="mode" value="Step mode" onClick = "modeChoice();">Step mode
							</td>
							<td>
								<input type="radio" name="mode" value="Run all" onClick = "modeChoice();">Run all
							</td>
							<td>
								<p id = "modeWord"></p>
							</td>
						</tr>	
					</table>
					<table>
						<tr>
							<td><p id = "speedPrompt">Speed：</p></td>
							<td>
								<input type="radio" name="speed" value="快" onClick = "speedChoice();">快
							</td>
							<td>
								<input type="radio" name="speed" value="中" onClick = "speedChoice();">中
							</td>
							<td>
								<input type="radio" name="speed" value="慢" onClick = "speedChoice();">慢
							</td>
							<td>
								<p id = "speedWord"></p>
							</td>
						</tr>	
					</table>
					<table>
						<tr>
							<td><p id = "speedPrompt">Step mode請按這；</p></td>
							<td><input type = "button" style=" width:100px;height:30px;font-size:15px;border:2px green solid " value = "Next" onClick = "stepExe();" id = "stepButton" ></td>
						</tr>
					</table>

					<table>
						<tr>
							<td><p id = "speedPrompt">你可以在這裡輸入你的答案：</p></td>
							<td><input type=text value="" id=userAnswer size="30" ></td>
						</tr>
					</table>

					<table>
						<tr>
							<td><p id = "speedPrompt">系統處理結果：</p></td>
							<td><input type=text value="" id=systemAnswer size="30" readonly="readonly"></td>
						</tr>
					</table>

					<table>
						<tr>
							<td><p id = "speedPrompt">Self-test比對結果：</p></td>
							<td><p id = "userResult"></p></td>
						</tr>
					</table>

					<!--
						Button design reference:
						http://csscodefile.blogspot.tw/2015/03/html-button.html
					-->
					<table>
						<tr>
							<td><input type = "button" style=" width:100px;height:30px;font-size:15px; border:2px green solid" value = "Clear all" onClick = "clearAll();" id = "clearButton"></td>
							<td><input type = "button" style="width:100px;height:30px;font-size:15px; border:2px green solid" value = "Check answer" onClick = "checkAnswer();" id = "answerButton" ></td>
						</tr>
					</table>
					<td>
					<td>
						<table>
							<tr>
								<td><p id = "stackWord">Stack狀態：</p></td>
							</tr>
							<tr>
								<td><input type=text style="border-top:3px black solid; border-left:3px black solid; border-bottom:3px black solid;" value="" id=stackText size="80" readonly="readonly"></td>	
							</tr>
						</table>

						<table>
							<tr>
								<td><p id = "location">top</p></td>
								
							</tr>
							<tr>
								
								<td><p id = "space1"></p></td>
								<td><p id = "space2"></p></td>
							</tr>
							<tr>
								<td><p id = "space3"></p></td>
								<td><p id = "space4"></p></td>
							</tr>
						</table>

						<table>
							<tr>
								<td><p id = "outputWord">output：</p></td>
								
							</tr>
							<tr>
								
								<td><p id = "space5"></p></td>
								<td><p id = "space6"></p></td>
							</tr>
							<tr>
								<td><p id = "space7"></p></td>
								<td><p id = "space8"></p></td>
							</tr>
							<tr>
								<td><input type=text value="" id=outputText size="80" readonly="readonly"></td>
							</tr>
						</table>

						<table>
							<tr>
								<td><p id = "allStepWord">目前過程：</p></td>
								
							</tr>
							<tr>
								<td><textarea name="Content" style="width:570px;height:100px;" id=currentStepTextArea readonly="readonly" ></textarea></td>
							</tr>
						</table>

						<table>
							<tr>
								<td><p id = "allStepWord">轉換過程：</p></td>
								
							</tr>
							<tr>
								<td><textarea name="Content" style="width:570px;height:200px;" id=allStepTextArea readonly="readonly" ></textarea></td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</form>
	</body>
	<script>
		// The function will be invoke, when you open the HTML file
		window.onload = function (){
			clearAll();
		}

		var mode = -1;
		var speed = -1;
		var fix = -1;// fix = 0 prefix,fix = 1 postfix
		var fixString = "";
		var stackStringStore = "";

		function fixChoice(){
				var form = document.getElementById("mathForm");
				var result = document.getElementById("fixWord");
			
				for (var i = 0; i < form.fix.length; i++) {
					if ( form.fix[i].checked ) {
						result.innerHTML = "<strong>"+"選擇 " + form.fix[i].value + "</strong>";
						fix = i;
						for (var i = 0; i < form.mode.length; i++) {
							form.mode[i].disabled = false;
						}			
						break;
					}
				}
		}// end function fixChoice()

		function fixClear(){
				var form = document.getElementById("mathForm");
				var result = document.getElementById("fixWord");
				for (var i = 0; i < form.fix.length; i++) {
					form.fix[i].checked = false;
				}

				result.innerHTML = "";

				for (var i = 0; i < form.mode.length; i++) {
					form.mode[i].disabled = true;
				}	

				
				fix = -1;
		}// end function fixClear()

		function modeChoice(){
				var form = document.getElementById("mathForm");
				var result = document.getElementById("modeWord");
			
				for (var i = 0; i < form.mode.length; i++) {
					if ( form.mode[i].checked ) {
						result.innerHTML = "<strong>" + "選擇 " + form.mode[i].value + "</strong>";
						mode = i;			
						break;
					}
				}
				if(mode == 0){
					for (var i = 0; i < form.speed.length; i++) {
						form.speed[i].disabled = true;
						form.speed[i].checked = false;
					}
					speedClear();
				}else{
					for (var i = 0; i < form.speed.length; i++) {
						form.speed[i].disabled = false;
					}
				}
		}// end function modeChoice()

		function modeClear(){
				var form = document.getElementById("mathForm");
				var result = document.getElementById("modeWord");
				for (var i = 0; i < form.mode.length; i++) {
					form.mode[i].checked = false;

				}
				result.innerHTML = "";
				mode = -1;

		}// end function modeClear()

		function speedChoice(){
				var form = document.getElementById("mathForm");
				var result = document.getElementById("speedWord");
			
				for (var i = 0; i < form.speed.length; i++) {
					if ( form.speed[i].checked ) {
						result.innerHTML = "<strong>" + "選擇 " + form.speed[i].value + "速</strong>";
						speed = i;			
						break;
					}
				}
		}// end function modeChoice()

		function speedClear(){
				var form = document.getElementById("mathForm");
				var result = document.getElementById("speedWord");
			
				for (var i = 0; i < form.speed.length; i++) {
					form.speed[i].checked = false;
					form.speed[i].disabled = true;
				}
				result.innerHTML = "";
				speed = -1;
		}// end function modeClear()

		function fixPreHandle(){
			var fixString = document.getElementById("inputInfix");
			var temp;// is a character array
			var str = ""; // temporarily store digit.
			var first = 1;
			var digitIsNeedToFind = 0;
			if(mode != -1){ // choose mode
				if(fix != -1){ // choose fix
					temp = (fixString.value).split(""); // sperate the string user input
					
					for(var count = 0; count < temp.length; count++){
						
						switch(temp[count]){
							case "0":
							case "1":
							case "2":
							case "3":
							case "4":
							case "5":
							case "6":
							case "7":
							case "8":
							case "9":
								str = str + temp[count];
								digitIsNeedToFind = 1;// Maybe the number is tens, hundreds, etc.
							break;
							case "+":
							case "-":
							case "*":
							case "/":
							case "(":
							case ")":
								if(digitIsNeedToFind == 1){
									if(first == 1){
										fixString = str;
										first = 0;
										str = "";
										digitIsNeedToFind = 0;
										count = count - 1;
									}else{
										fixString = fixString + " " + str;
										count = count - 1;
										digitIsNeedToFind = 0;
										str = "";
									}
									
								}else{
									if(first == 1){
										fixString = temp[count];
										first = 0;
									}else{
										fixString = fixString + " " + temp[count];
									}
								}
							break;
							default:
								if(digitIsNeedToFind == 1){
									if(first == 1){
										fixString = temp[count];
										first = 0;
									}else{
										fixString = fixString + " " + str;
										digitIsNeedToFind = 0;
										str = "";
									}	
								}
						}// end switch
					}// end for loop

					if(str != ""){ // reserve character need to check
						fixString = fixString + " " + str;
					}
					document.getElementById("currentStepTextArea").innerHTML = fixString;
				}// end if
			}// end if
		}// end function fixPreHandle()

		function stepExe(){
			fixPreHandle();
		}// end function stepExe()

		function dataDelete(){
			document.getElementById("inputInfix").value = ""; // text field clear data should use the value attribute.
			//document.getElementById("inputInfix").innerHTML = "";
			fixString = "";
			stackStringStore = "";
		}

		function clearAll(){
			modeClear();
			speedClear();
			fixClear();
			dataDelete();
		}
	</script>
</html>
